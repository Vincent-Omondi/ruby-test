<!DOCTYPE html>
<html>
  <head>
    <title>Test Project</title>
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <%= csrf_meta_tags %>
    <%= csp_meta_tag %>

    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" crossorigin="" />
    
    <!-- Import Tailwind CSS directly from CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
      tailwind.config = {
        theme: {
          extend: {
            colors: {
              primary: '#3D2D1C',
              secondary: '#F8C05C',
              accent: '#4A90E2',
            },
            fontFamily: {
              sans: ['Inter', 'system-ui', 'sans-serif'],
              serif: ['Georgia', 'serif'],
            },
          }
        }
      }
    </script>
    
    <!-- Ensure we have basic styles applied -->
    <style>
      body {
        margin: 0;
        padding: 0;
        font-family: 'Inter', system-ui, sans-serif;
        color: #333;
        line-height: 1.5;
      }
      .container {
        max-width: 1200px;
        margin: 0 auto;
        padding: 0 1rem;
      }
    </style>
    
    <%= stylesheet_link_tag "application", "data-turbo-track": "reload" %>
    <%= stylesheet_link_tag "application.tailwind", "data-turbo-track": "reload" %>
    <%= javascript_include_tag "application", "data-turbo-track": "reload", type: "module" %>
  </head>

  <body>
    <%= content_for(:head) %>
    <% 
      # Prepare the Inertia data outside of the HTML
      inertia_data = if defined?(@inertia)
                       @inertia
                     elsif defined?(@inertia_data)
                       @inertia_data
                     else
                       nil
                     end
      
      # Always ensure URL is included if we have data
      if inertia_data
        inertia_data[:url] ||= request.original_url
        
        # Ensure component name isn't altered
        if inertia_data[:component].present? && inertia_data[:component].include?('/')
          inertia_data[:component] = inertia_data[:component].to_s
        end
        
        data_attribute = raw(inertia_data.to_json)
      else 
        data_attribute = '{}'
      end
    %>
    <div id="app" data-page='<%= data_attribute %>'></div>
  </body>
</html> 